<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุณุงุจูุฉ ุจุงุญุซุงุช ุงูุชุฃุณูุณ | ุฑุญูุฉ ุงูุชุฃุณูุณ</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="competition.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- ุดุฑูุท ุงูุชููู -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <img src="../assets/images/logo.png" alt="ุดุนุงุฑ ููู ุงูุชุฃุณูุณ" class="logo-img">
                <span class="logo-text">ุฑุญูุฉ ุงูุชุฃุณูุณ</span>
            </div>
            
            <div class="nav-menu">
                <a href="../index.html" class="nav-link"><i class="fas fa-home"></i> ุงูุฑุฆูุณูุฉ</a>
                <a href="../exhibits/" class="nav-link"><i class="fas fa-landmark"></i> ุงููุนุงุฑุถ</a>
                <a href="index.html" class="nav-link active"><i class="fas fa-trophy"></i> ุงููุณุงุจูุฉ</a>
                <a href="../games/" class="nav-link"><i class="fas fa-gamepad"></i> ุงูุฃูุนุงุจ</a>
                
                <div class="user-points">
                    <i class="fas fa-coins"></i>
                    <span id="userPoints">ู</span> ููุทุฉ
                </div>
            </div>
        </div>
    </nav>

    <!-- ุฑุฃุณ ุตูุญุฉ ุงููุณุงุจูุฉ -->
    <header class="competition-header">
        <div class="header-content">
            <h1 class="competition-title">ูุณุงุจูุฉ "ุจุงุญุซุงุช ุงูุชุฃุณูุณ"</h1>
            <p class="competition-subtitle">ุชุญุฏู ุงููุนุฑูุฉ ูุงูุชุฑุงุซ - ุงุฑุจุญู ุงูููุงุท ูุชุตุนุฏู ูู ููุญุฉ ุงูุตุฏุงุฑุฉ</p>
            
            <div class="competition-status">
                <div class="status-card">
                    <i class="fas fa-calendar-alt"></i>
                    <div>
                        <h4>ุงููุฑุญูุฉ ุงูุญุงููุฉ</h4>
                        <p>ุงูุชุตููุงุช ุงูููุงุฆูุฉ</p>
                    </div>
                </div>
                
                <div class="status-card">
                    <i class="fas fa-clock"></i>
                    <div>
                        <h4>ุงูููุช ุงููุชุจูู</h4>
                        <p id="competitionTimer">ููง:ูขูฃ:ูกูฅ</p>
                    </div>
                </div>
                
                <div class="status-card">
                    <i class="fas fa-users"></i>
                    <div>
                        <h4>ุงููุดุงุฑูุงุช</h4>
                        <p id="totalParticipants">ูก,ูฃูคูง</p>
                    </div>
                </div>
                
                <div class="status-card">
                    <i class="fas fa-gift"></i>
                    <div>
                        <h4>ุงูุฌูุงุฆุฒ ุงููููุฉ</h4>
                        <p>ูฅู+ ุฌุงุฆุฒุฉ</p>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- ูุณู ุงููุณุงุจูุฉ ุงูุฑุฆูุณู -->
    <main class="competition-main">
        <div class="container">
            <div class="competition-layout">
                <!-- ููุญุฉ ุงูุชุญูู -->
                <aside class="competition-sidebar">
                    <div class="user-profile-card">
                        <div class="profile-header">
                            <img src="../assets/images/default-avatar.png" alt="ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ" class="profile-avatar">
                            <div class="profile-info">
                                <h3 id="userName">ุฒุงุฆุฑ</h3>
                                <p class="profile-level">ุงููุณุชูู: <span id="userLevel">ู</span></p>
                            </div>
                        </div>
                        
                        <div class="profile-stats">
                            <div class="stat">
                                <i class="fas fa-trophy"></i>
                                <div>
                                    <span class="stat-value" id="userRank">--</span>
                                    <span class="stat-label">ุงูุชุฑุชูุจ</span>
                                </div>
                            </div>
                            
                            <div class="stat">
                                <i class="fas fa-star"></i>
                                <div>
                                    <span class="stat-value" id="userScore">ู</span>
                                    <span class="stat-label">ุงูููุงุท</span>
                                </div>
                            </div>
                            
                            <div class="stat">
                                <i class="fas fa-check-circle"></i>
                                <div>
                                    <span class="stat-value" id="userQuizzes">ู</span>
                                    <span class="stat-label">ุงุฎุชุจุงุฑ</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="profile-progress">
                            <h4>ุงูุชูุฏู ูููุณุชูู ุงูุชุงูู</h4>
                            <div class="progress-bar">
                                <div class="progress-fill" id="levelProgress" style="width: 0%"></div>
                            </div>
                            <span class="progress-text" id="progressText">ู/ูกูู ููุทุฉ</span>
                        </div>
                    </div>
                    
                    <nav class="sidebar-nav">
                        <a href="#dailyQuiz" class="sidebar-link active">
                            <i class="fas fa-question-circle"></i>
                            ุงูุงุฎุชุจุงุฑ ุงููููู
                        </a>
                        
                        <a href="#categories" class="sidebar-link">
                            <i class="fas fa-layer-group"></i>
                            ูุฆุงุช ุงูุฃุณุฆูุฉ
                        </a>
                        
                        <a href="#leaderboard" class="sidebar-link">
                            <i class="fas fa-ranking-star"></i>
                            ููุญุฉ ุงูุตุฏุงุฑุฉ
                        </a>
                        
                        <a href="#achievements" class="sidebar-link">
                            <i class="fas fa-medal"></i>
                            ุงูุฅูุฌุงุฒุงุช
                        </a>
                        
                        <a href="#prizes" class="sidebar-link">
                            <i class="fas fa-gift"></i>
                            ุงูุฌูุงุฆุฒ
                        </a>
                        
                        <a href="#rules" class="sidebar-link">
                            <i class="fas fa-scroll"></i>
                            ุงูููุงุนุฏ
                        </a>
                    </nav>
                    
                    <div class="quick-stats">
                        <h4>ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ</h4>
                        <div class="quick-stat">
                            <span>ูุชูุณุท ุงูููุงุท ุงูููู:</span>
                            <span class="stat-value">ูคูจูฅ</span>
                        </div>
                        <div class="quick-stat">
                            <span>ุฃุณุฆูุฉ ุงูููู:</span>
                            <span class="stat-value">ูกูฅ</span>
                        </div>
                        <div class="quick-stat">
                            <span>ุงููุงุฆุฒูู ุงูููู:</span>
                            <span class="stat-value">ูฅ</span>
                        </div>
                    </div>
                </aside>
                
                <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
                <div class="competition-content">
                    <!-- ุงูุงุฎุชุจุงุฑ ุงููููู -->
                    <section id="dailyQuiz" class="content-section active">
                        <div class="section-header">
                            <h2>ุงูุงุฎุชุจุงุฑ ุงููููู</h2>
                            <div class="quiz-timer">
                                <i class="fas fa-clock"></i>
                                <span id="quizTimer">ููข:ูู</span>
                            </div>
                        </div>
                        
                        <div class="quiz-container">
                            <div class="quiz-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="quizProgress" style="width: 0%"></div>
                                </div>
                                <span class="progress-text">ุงูุณุคุงู <span id="currentQuestion">ูก</span> ูู ูกู</span>
                            </div>
                            
                            <div class="quiz-question" id="quizQuestion">
                                <!-- ุณูุชู ุชุญููู ุงูุณุคุงู ุฏููุงููููุงู -->
                            </div>
                            
                            <div class="quiz-actions">
                                <button class="btn-secondary" id="skipBtn" onclick="skipQuestion()">
                                    <i class="fas fa-forward"></i> ุชุฎุทู
                                </button>
                                
                                <button class="btn-primary" id="nextBtn" onclick="nextQuestion()" disabled>
                                    ุงูุชุงูู <i class="fas fa-arrow-left"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="quiz-categories">
                            <h3>ูุฆุงุช ุงูุฃุณุฆูุฉ ุงููุชุจููุฉ</h3>
                            <div class="categories-grid">
                                <div class="category-card" data-category="history">
                                    <i class="fas fa-landmark"></i>
                                    <span>ุงูุชุงุฑูุฎ</span>
                                    <span class="questions-left">ูฅ ุฃุณุฆูุฉ</span>
                                </div>
                                
                                <div class="category-card" data-category="heritage">
                                    <i class="fas fa-archway"></i>
                                    <span>ุงูุชุฑุงุซ</span>
                                    <span class="questions-left">ูฃ ุฃุณุฆูุฉ</span>
                                </div>
                                
                                <div class="category-card" data-category="geography">
                                    <i class="fas fa-map"></i>
                                    <span>ุงูุฌุบุฑุงููุง</span>
                                    <span class="questions-left">ูข ุฃุณุฆูุฉ</span>
                                </div>
                            </div>
                        </div>
                    </section>
                    
                    <!-- ููุญุฉ ุงูุตุฏุงุฑุฉ -->
                    <section id="leaderboard" class="content-section">
                        <div class="section-header">
                            <h2>ููุญุฉ ุงูุตุฏุงุฑุฉ</h2>
                            <div class="leaderboard-filters">
                                <select id="timeFilter" onchange="updateLeaderboard()">
                                    <option value="daily">ุงููููู</option>
                                    <option value="weekly">ุงูุฃุณุจูุนู</option>
                                    <option value="monthly">ุงูุดูุฑู</option>
                                    <option value="all">ุงูููู</option>
                                </select>
                                
                                <select id="categoryFilter" onchange="updateLeaderboard()">
                                    <option value="all">ุฌููุน ุงููุฆุงุช</option>
                                    <option value="history">ุงูุชุงุฑูุฎ</option>
                                    <option value="heritage">ุงูุชุฑุงุซ</option>
                                    <option value="geography">ุงูุฌุบุฑุงููุง</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="leaderboard-container">
                            <div class="leaderboard-header">
                                <div class="rank-col">ุงูุชุฑุชูุจ</div>
                                <div class="name-col">ุงููุดุงุฑู</div>
                                <div class="score-col">ุงูููุงุท</div>
                                <div class="level-col">ุงููุณุชูู</div>
                                <div class="accuracy-col">ุงูุฏูุฉ</div>
                            </div>
                            
                            <div class="leaderboard-body" id="leaderboardBody">
                                <!-- ุณูุชู ุชุนุจุฆุชู ุฏููุงููููุงู -->
                            </div>
                            
                            <!-- ุชุฑุชูุจ ุงููุณุชุฎุฏู ุงูุญุงูู -->
                            <div class="user-rank-card">
                                <div class="user-rank-info">
                                    <span class="rank-badge" id="userRankBadge">--</span>
                                    <img src="../assets/images/default-avatar.png" alt="ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ" class="rank-avatar">
                                    <div class="rank-details">
                                        <h4 id="userRankName">ุฒุงุฆุฑ</h4>
                                        <p>ุงูููุงุท: <span id="userRankScore">ู</span></p>
                                    </div>
                                </div>
                                
                                <div class="rank-stats">
                                    <div class="stat">
                                        <span class="stat-label">ุงูุฏูุฉ</span>
                                        <span class="stat-value" id="userAccuracy">ููช</span>
                                    </div>
                                    
                                    <div class="stat">
                                        <span class="stat-label">ุงูุงุฎุชุจุงุฑุงุช</span>
                                        <span class="stat-value" id="userQuizzesCount">ู</span>
                                    </div>
                                    
                                    <div class="stat">
                                        <span class="stat-label">ุงููุณุชูู</span>
                                        <span class="stat-value" id="userLevelRank">ู</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    
                    <!-- ุงูุฅูุฌุงุฒุงุช -->
                    <section id="achievements" class="content-section">
                        <div class="section-header">
                            <h2>ุงูุฅูุฌุงุฒุงุช ูุงูุฃูุณูุฉ</h2>
                            <div class="achievement-summary">
                                <div class="summary-card">
                                    <i class="fas fa-trophy"></i>
                                    <div>
                                        <h4>ุงูุฃูุณูุฉ</h4>
                                        <p><span id="achievementsCount">ู</span> / ูขูฅ</p>
                                    </div>
                                </div>
                                
                                <div class="summary-card">
                                    <i class="fas fa-star"></i>
                                    <div>
                                        <h4>ููุงุท ุงูุฅูุฌุงุฒ</h4>
                                        <p id="achievementPoints">ู</p>
                                    </div>
                                </div>
                                
                                <div class="summary-card">
                                    <i class="fas fa-crown"></i>
                                    <div>
                                        <h4>ุงูุฃููุงุจ</h4>
                                        <p id="titlesCount">ู</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="achievements-grid" id="achievementsGrid">
                            <!-- ุณูุชู ุชุนุจุฆุชู ุฏููุงููููุงู -->
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </main>

    <!-- ุงูููุชุฑ -->
    <footer>
        <div class="footer-container">
            <!-- ููุณ ุงูููุชุฑ ุงูุณุงุจู -->
        </div>
    </footer>

    <!-- ูุงูุฐุฉ ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑ -->
    <div id="quizResultsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeQuizResults()">&times;</span>
            
            <div class="results-content">
                <div class="results-header">
                    <h2>๐ ุฃุญุณูุช! ๐</h2>
                    <p>ููุฏ ุฃูููุช ุงูุงุฎุชุจุงุฑ ุงููููู ุจูุฌุงุญ</p>
                </div>
                
                <div class="results-stats">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="stat-info">
                            <h3>ุงูููุงุท</h3>
                            <p class="stat-value" id="resultsPoints">ู</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-info">
                            <h3>ุงูุฏูุฉ</h3>
                            <p class="stat-value" id="resultsAccuracy">ููช</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <h3>ุงูููุช</h3>
                            <p class="stat-value" id="resultsTime">ูู:ูู</p>
                        </div>
                    </div>
                </div>
                
                <div class="results-breakdown">
                    <h3>ุชูุตูู ุงููุชุงุฆุฌ</h3>
                    <div class="breakdown-list" id="categoryBreakdown">
                        <!-- ุณูุชู ุชุนุจุฆุชู ุฏููุงููููุงู -->
                    </div>
                </div>
                
                <div class="results-actions">
                    <button class="btn-primary" onclick="shareResults()">
                        <i class="fas fa-share"></i> ุดุงุฑู ุงููุชูุฌุฉ
                    </button>
                    
                    <button class="btn-secondary" onclick="retakeQuiz()">
                        <i class="fas fa-redo"></i> ุญุงูู ูุฑุฉ ุฃุฎุฑู
                    </button>
                    
                    <button class="btn-secondary" onclick="continueToLeaderboard()">
                        <i class="fas fa-ranking-star"></i> ููุญุฉ ุงูุตุฏุงุฑุฉ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="../script.js"></script>
    <script src="competition.js"></script>
    <script>
        // ููุฏ ุฎุงุต ุจุงููุณุงุจูุฉ
        class Competition {
            constructor() {
                this.user = null;
                this.questions = [];
                this.currentQuestion = 0;
                this.score = 0;
                this.timer = null;
                this.timeLeft = 120; // 2 ุฏูููุฉ
                this.quizStarted = false;
                
                this.init();
            }
            
            async init() {
                this.loadUserData();
                this.loadQuestions();
                this.setupEventListeners();
                this.startCompetitionTimer();
                this.updateLeaderboard();
                this.loadAchievements();
            }
            
            loadUserData() {
                const savedUser = localStorage.getItem('user');
                if (savedUser) {
                    this.user = JSON.parse(savedUser);
                    this.updateUserUI();
                } else {
                    // ุฅุฐุง ูู ููู ูุณุฌูุงูุ ุชูุฌูู ูุชุณุฌูู ุงูุฏุฎูู
                    setTimeout(() => {
                        if (!this.user) {
                            alert('ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ูููุดุงุฑูุฉ ูู ุงููุณุงุจูุฉ');
                            window.location.href = '../index.html';
                        }
                    }, 1000);
                }
            }
            
            updateUserUI() {
                if (!this.user) return;
                
                document.getElementById('userName').textContent = this.user.name;
                document.getElementById('userPoints').textContent = this.user.points.toLocaleString('ar-SA');
                document.getElementById('userLevel').textContent = this.user.level;
                document.getElementById('userScore').textContent = this.user.points.toLocaleString('ar-SA');
                
                // ุญุณุงุจ ุงูุชูุฏู ูููุณุชูู ุงูุชุงูู
                const nextLevelPoints = this.user.level * 1000;
                const progress = (this.user.points % 1000) / 10;
                document.getElementById('levelProgress').style.width = `${progress}%`;
                document.getElementById('progressText').textContent = 
                    `${this.user.points % 1000}/ูกููู ููุทุฉ`;
            }
            
            async loadQuestions() {
                // ูุญุงูุงุฉ ุชุญููู ุงูุฃุณุฆูุฉ ูู API
                this.questions = [
                    {
                        id: 1,
                        question: "ูู ุฃู ุนุงู ุชุฃุณุณุช ุงูุฏููุฉ ุงูุณุนูุฏูุฉ ุงูุฃูููุ",
                        options: ["ูกูงูขูงู", "ูกูงูคูคู", "ูกูจูกูจู", "ูกูฉููขู"],
                        correct: 0,
                        category: "history",
                        points: 10,
                        explanation: "ุชุฃุณุณุช ุงูุฏููุฉ ุงูุณุนูุฏูุฉ ุงูุฃููู ุนุงู ูกูงูขูงู ุนูู ูุฏ ุงูุฅูุงู ูุญูุฏ ุจู ุณุนูุฏ."
                    },
                    // ุงููุฒูุฏ ูู ุงูุฃุณุฆูุฉ...
                ];
                
                // ุฅุฐุง ูุงู ููุงู ุงุฎุชุจุงุฑ ูููู ูุฎุฒูุ ุชุญูููู
                const savedQuiz = localStorage.getItem('dailyQuiz');
                if (savedQuiz) {
                    const quizData = JSON.parse(savedQuiz);
                    const today = new Date().toDateString();
                    
                    if (quizData.date === today && quizData.completed) {
                        this.showQuizCompleted();
                    } else if (quizData.date === today) {
                        this.questions = quizData.questions;
                        this.currentQuestion = quizData.currentQuestion;
                        this.score = quizData.score;
                        this.timeLeft = quizData.timeLeft;
                        this.quizStarted = true;
                        this.startQuiz();
                    }
                }
            }
            
            startQuiz() {
                if (!this.quizStarted) {
                    this.quizStarted = true;
                    this.saveQuizProgress();
                    this.startTimer();
                }
                
                this.displayCurrentQuestion();
                this.updateQuizProgress();
            }
            
            displayCurrentQuestion() {
                if (this.currentQuestion >= this.questions.length) {
                    this.completeQuiz();
                    return;
                }
                
                const question = this.questions[this.currentQuestion];
                const quizDiv = document.getElementById('quizQuestion');
                
                quizDiv.innerHTML = `
                    <div class="question-header">
                        <span class="question-category">
                            <i class="fas fa-${this.getCategoryIcon(question.category)}"></i>
                            ${this.getCategoryName(question.category)}
                        </span>
                        <span class="question-points">${question.points} ููุงุท</span>
                    </div>
                    
                    <h3 class="question-text">${question.question}</h3>
                    
                    <div class="question-options">
                        ${question.options.map((option, index) => `
                            <div class="option-card" data-index="${index}">
                                <span class="option-letter">${String.fromCharCode(1570 + index)}</span>
                                <span class="option-text">${option}</span>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                // ุฅุถุงูุฉ ูุณุชูุนุงุช ุงูุฃุญุฏุงุซ ููุฎูุงุฑุงุช
                document.querySelectorAll('.option-card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        this.selectOption(parseInt(card.dataset.index));
                    });
                });
                
                document.getElementById('currentQuestion').textContent = this.currentQuestion + 1;
                this.updateQuizProgress();
            }
            
            selectOption(selectedIndex) {
                const question = this.questions[this.currentQuestion];
                const options = document.querySelectorAll('.option-card');
                
                // ุฅูุบุงุก ุชูุนูู ุฌููุน ุงูุฎูุงุฑุงุช
                options.forEach(opt => opt.style.pointerEvents = 'none');
                
                // ุนุฑุถ ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ูุงูุฎุงุทุฆุฉ
                options.forEach((opt, index) => {
                    if (index === question.correct) {
                        opt.classList.add('correct');
                    } else if (index === selectedIndex && index !== question.correct) {
                        opt.classList.add('incorrect');
                    }
                });
                
                // ุชุญุฏูุซ ุงูููุงุท
                if (selectedIndex === question.correct) {
                    this.score += question.points;
                    this.showFeedback('ุตุญูุญ! ๐', 'success');
                } else {
                    this.showFeedback('ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ', 'error');
                }
                
                // ุชูููู ุฒุฑ ุงูุชุงูู
                document.getElementById('nextBtn').disabled = false;
                
                // ุญูุธ ุงูุชูุฏู
                this.saveQuizProgress();
            }
            
            nextQuestion() {
                this.currentQuestion++;
                
                if (this.currentQuestion >= this.questions.length) {
                    this.completeQuiz();
                } else {
                    this.displayCurrentQuestion();
                    document.getElementById('nextBtn').disabled = true;
                }
            }
            
            skipQuestion() {
                this.currentQuestion++;
                this.saveQuizProgress();
                
                if (this.currentQuestion >= this.questions.length) {
                    this.completeQuiz();
                } else {
                    this.displayCurrentQuestion();
                }
            }
            
            startTimer() {
                clearInterval(this.timer);
                
                this.timer = setInterval(() => {
                    this.timeLeft--;
                    this.updateQuizTimer();
                    
                    if (this.timeLeft <= 0) {
                        clearInterval(this.timer);
                        this.completeQuiz();
                    }
                    
                    this.saveQuizProgress();
                }, 1000);
            }
            
            updateQuizTimer() {
                const minutes = Math.floor(this.timeLeft / 60);
                const seconds = this.timeLeft % 60;
                
                document.getElementById('quizTimer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            updateQuizProgress() {
                const progress = ((this.currentQuestion) / this.questions.length) * 100;
                document.getElementById('quizProgress').style.width = `${progress}%`;
            }
            
            async completeQuiz() {
                clearInterval(this.timer);
                
                // ุชุญุฏูุซ ููุงุท ุงููุณุชุฎุฏู
                this.user.points += this.score;
                localStorage.setItem('user', JSON.stringify(this.user));
                
                // ุญูุธ ุณุฌู ุงูุงุฎุชุจุงุฑ
                const quizResult = {
                    date: new Date().toISOString(),
                    score: this.score,
                    totalQuestions: this.questions.length,
                    timeSpent: 120 - this.timeLeft,
                    accuracy: Math.round((this.score / (this.questions.length * 10)) * 100)
                };
                
                this.saveQuizHistory(quizResult);
                
                // ุนุฑุถ ุงููุชุงุฆุฌ
                this.showQuizResults(quizResult);
                
                // ุฅุนุงุฏุฉ ุชุนููู ุงููุชุบูุฑุงุช
                this.quizStarted = false;
                localStorage.removeItem('dailyQuiz');
            }
            
            showQuizResults(result) {
                document.getElementById('resultsPoints').textContent = result.score;
                document.getElementById('resultsAccuracy').textContent = `${result.accuracy}ูช`;
                document.getElementById('resultsTime').textContent = 
                    `${Math.floor(result.timeSpent / 60)}:${(result.timeSpent % 60).toString().padStart(2, '0')}`;
                
                // ุนุฑุถ ูุชุงุฆุฌ ุงููุฆุงุช
                this.displayCategoryBreakdown();
                
                // ุนุฑุถ ุงููุงูุฐุฉ ุงูููุจุซูุฉ
                document.getElementById('quizResultsModal').style.display = 'flex';
            }
            
            displayCategoryBreakdown() {
                // ุญุณุงุจ ุงููุชุงุฆุฌ ุญุณุจ ุงููุฆุฉ
                const breakdown = {};
                
                this.questions.forEach((q, index) => {
                    if (!breakdown[q.category]) {
                        breakdown[q.category] = {
                            correct: 0,
                            total: 0,
                            points: 0
                        };
                    }
                    
                    breakdown[q.category].total++;
                    // ููุง ูููู ุฅุถุงูุฉ ููุทู ููุชุญูู ูู ุงูุฅุฌุงุจุงุช ุงูุตุญูุญุฉ
                });
                
                const breakdownDiv = document.getElementById('categoryBreakdown');
                breakdownDiv.innerHTML = Object.entries(breakdown).map(([category, data]) => `
                    <div class="breakdown-item">
                        <div class="breakdown-header">
                            <i class="fas fa-${this.getCategoryIcon(category)}"></i>
                            <span>${this.getCategoryName(category)}</span>
                        </div>
                        <div class="breakdown-stats">
                            <span>${data.correct}/${data.total}</span>
                            <span>${data.points} ููุทุฉ</span>
                        </div>
                    </div>
                `).join('');
            }
            
            saveQuizProgress() {
                const quizData = {
                    date: new Date().toDateString(),
                    questions: this.questions,
                    currentQuestion: this.currentQuestion,
                    score: this.score,
                    timeLeft: this.timeLeft,
                    completed: false
                };
                
                localStorage.setItem('dailyQuiz', JSON.stringify(quizData));
            }
            
            saveQuizHistory(result) {
                let history = JSON.parse(localStorage.getItem('quizHistory') || '[]');
                history.push(result);
                localStorage.setItem('quizHistory', JSON.stringify(history));
            }
            
            showQuizCompleted() {
                const quizDiv = document.getElementById('quizQuestion');
                quizDiv.innerHTML = `
                    <div class="quiz-completed">
                        <i class="fas fa-check-circle"></i>
                        <h3>ููุฏ ุฃูููุช ุงูุงุฎุชุจุงุฑ ุงููููู ุจุงููุนู!</h3>
                        <p>ุนุฏ ุบุฏุงู ูุงุฎุชุจุงุฑ ุฌุฏูุฏ ููุฒูุฏ ูู ุงูููุงุท.</p>
                        <button class="btn-primary" onclick="viewPreviousResults()">
                            ุนุฑุถ ุงููุชุงุฆุฌ ุงูุณุงุจูุฉ
                        </button>
                    </div>
                `;
                
                document.getElementById('nextBtn').style.display = 'none';
                document.getElementById('skipBtn').style.display = 'none';
            }
            
            startCompetitionTimer() {
                // ุนุฏ ุชูุงุฒูู ูููุณุงุจูุฉ ุงูุนุงูุฉ
                setInterval(() => {
                    const now = new Date();
                    const endOfDay = new Date();
                    endOfDay.setHours(23, 59, 59, 999);
                    
                    const timeLeft = endOfDay - now;
                    const hours = Math.floor(timeLeft / (1000 * 60 * 60));
                    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                    
                    document.getElementById('competitionTimer').textContent = 
                        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }, 1000);
            }
            
            async updateLeaderboard() {
                // ูุญุงูุงุฉ ุจูุงูุงุช ููุญุฉ ุงูุตุฏุงุฑุฉ
                const leaderboardData = [
                    { name: "ููุฑุฉ ุฃุญูุฏ", points: 985, level: 5, accuracy: 92, quizzes: 47 },
                    { name: "ุณุงุฑุฉ ุงูุฎุงูุฏู", points: 972, level: 5, accuracy: 89, quizzes: 45 },
                    { name: "ูุงุทูุฉ ุงูุนุชูุจู", points: 965, level: 4, accuracy: 88, quizzes: 42 },
                    // ุงููุฒูุฏ ูู ุงูุจูุงูุงุช...
                ];
                
                const leaderboardBody = document.getElementById('leaderboardBody');
                leaderboardBody.innerHTML = leaderboardData.map((user, index) => `
                    <div class="leaderboard-row ${index < 3 ? 'top-three' : ''}">
                        <div class="rank-col">
                            <span class="rank-number">${index + 1}</span>
                            ${index < 3 ? '<i class="fas fa-crown"></i>' : ''}
                        </div>
                        <div class="name-col">
                            <img src="../assets/images/avatar-${index + 1}.png" alt="${user.name}" class="user-avatar">
                            <span>${user.name}</span>
                        </div>
                        <div class="score-col">
                            <span class="score-value">${user.points}</span>
                        </div>
                        <div class="level-col">
                            <span class="level-badge">ุงููุณุชูู ${user.level}</span>
                        </div>
                        <div class="accuracy-col">
                            <div class="accuracy-bar">
                                <div class="accuracy-fill" style="width: ${user.accuracy}%"></div>
                            </div>
                            <span class="accuracy-value">${user.accuracy}%</span>
                        </div>
                    </div>
                `).join('');
            }
            
            async loadAchievements() {
                // ูุญุงูุงุฉ ุจูุงูุงุช ุงูุฅูุฌุงุฒุงุช
                const achievements = [
                    { id: 1, name: "ุงูุจุงุญุซ ุงููุจุชุฏุฆ", description: "ุฃููู ุฃูู ุงุฎุชุจุงุฑ", icon: "fas fa-graduation-cap", earned: true, points: 50 },
                    { id: 2, name: "ุจุทู ุงูุชุงุฑูุฎ", description: "ุฃุฌุจ ุนูู 10 ุฃุณุฆูุฉ ุชุงุฑูุฎูุฉ ุจุดูู ุตุญูุญ", icon: "fas fa-landmark", earned: true, points: 100 },
                    { id: 3, name: "ุณูุฏ ุงูุชุฑุงุซ", description: "ุฃููู ุฌููุน ุฃุณุฆูุฉ ุงูุชุฑุงุซ", icon: "fas fa-archway", earned: false, points: 150 },
                    // ุงููุฒูุฏ ูู ุงูุฅูุฌุงุฒุงุช...
                ];
                
                const earnedCount = achievements.filter(a => a.earned).length;
                const totalPoints = achievements.filter(a => a.earned).reduce((sum, a) => sum + a.points, 0);
                
                document.getElementById('achievementsCount').textContent = earnedCount;
                document.getElementById('achievementPoints').textContent = totalPoints;
                
                const achievementsGrid = document.getElementById('achievementsGrid');
                achievementsGrid.innerHTML = achievements.map(achievement => `
                    <div class="achievement-card ${achievement.earned ? 'earned' : 'locked'}">
                        <div class="achievement-icon">
                            <i class="${achievement.icon}"></i>
                            ${achievement.earned ? '' : '<i class="fas fa-lock lock-icon"></i>'}
                        </div>
                        <div class="achievement-info">
                            <h4>${achievement.name}</h4>
                            <p>${achievement.description}</p>
                            <span class="achievement-points">${achievement.points} ููุทุฉ</span>
                        </div>
                        <div class="achievement-status">
                            ${achievement.earned ? 
                                '<i class="fas fa-check-circle"></i>' : 
                                '<i class="far fa-clock"></i>'
                            }
                        </div>
                    </div>
                `).join('');
            }
            
            getCategoryIcon(category) {
                const icons = {
                    history: 'landmark',
                    heritage: 'archway',
                    geography: 'map',
                    culture: 'music',
                    vision: 'chart-line'
                };
                return icons[category] || 'question-circle';
            }
            
            getCategoryName(category) {
                const names = {
                    history: 'ุงูุชุงุฑูุฎ',
                    heritage: 'ุงูุชุฑุงุซ',
                    geography: 'ุงูุฌุบุฑุงููุง',
                    culture: 'ุงูุซูุงูุฉ',
                    vision: 'ุงูุฑุคูุฉ'
                };
                return names[category] || 'ุนุงู';
            }
            
            showFeedback(message, type) {
                const feedback = document.createElement('div');
                feedback.className = `feedback feedback-${type}`;
                feedback.textContent = message;
                feedback.style.cssText = `
                    position: fixed;
                    top: 100px;
                    right: 20px;
                    padding: 15px 25px;
                    background-color: ${type === 'success' ? '#4CAF50' : '#F44336'};
                    color: white;
                    border-radius: 8px;
                    z-index: 3000;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    animation: slideInRight 0.3s ease-out;
                `;
                
                document.body.appendChild(feedback);
                
                setTimeout(() => {
                    feedback.style.animation = 'slideOutRight 0.3s ease-out';
                    setTimeout(() => feedback.remove(), 300);
                }, 2000);
            }
            
            setupEventListeners() {
                // ุงูุชููู ุจูู ุงูุฃูุณุงู
                document.querySelectorAll('.sidebar-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        
                        const targetId = link.getAttribute('href').substring(1);
                        this.showSection(targetId);
                        
                        // ุชุญุฏูุซ ุงูุฑูุงุจุท ุงููุดุทุฉ
                        document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
                        link.classList.add('active');
                    });
                });
                
                // ุจุฏุก ุงูุงุฎุชุจุงุฑ
                if (!this.quizStarted && document.getElementById('startQuizBtn')) {
                    document.getElementById('startQuizBtn').addEventListener('click', () => {
                        this.startQuiz();
                    });
                }
            }
            
            showSection(sectionId) {
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                document.getElementById(sectionId).classList.add('active');
            }
        }
        
        // ุชููุฆุฉ ุงููุณุงุจูุฉ
        let competition;
        document.addEventListener('DOMContentLoaded', () => {
            competition = new Competition();
        });
        
        // ูุธุงุฆู ุนุงูุฉ
        function closeQuizResults() {
            document.getElementById('quizResultsModal').style.display = 'none';
        }
        
        function shareResults() {
            const score = document.getElementById('resultsPoints').textContent;
            const accuracy = document.getElementById('resultsAccuracy').textContent;
            
            const shareText = `๐ฏ ุญุตูุช ุนูู ${score} ููุทุฉ ุจุฏูุฉ ${accuracy} ูู ูุณุงุจูุฉ "ุจุงุญุซุงุช ุงูุชุฃุณูุณ"!\n\nุงูุถู ุฅูู ุงููุณุงุจูุฉ ุนูู: ${window.location.origin}`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'ูุชูุฌุชู ูู ูุณุงุจูุฉ ุจุงุญุซุงุช ุงูุชุฃุณูุณ',
                    text: shareText,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('ุชู ูุณุฎ ุงููุชูุฌุฉ ุฅูู ุงูุญุงูุธุฉ! ููููู ูุดุงุฑูุชูุง ุงูุขู.');
                });
            }
        }
        
        function retakeQuiz() {
            location.reload();
        }
        
        function continueToLeaderboard() {
            closeQuizResults();
            competition.showSection('leaderboard');
        }
        
        function viewPreviousResults() {
            competition.showSection('achievements');
        }
    </script>
</body>
</html>